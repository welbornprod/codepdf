<html>
<head>
<title>CodePDF Example Output</title>
<style type="text/css">
body {font-family: sans-serif;}
.hilight .hll { background-color: #49483e }
.hilight  { background: #272822; color: #f8f8f2 }
.hilight .c { color: #75715e } /* Comment */
.hilight .err { color: #960050; background-color: #1e0010 } /* Error */
.hilight .k { color: #66d9ef } /* Keyword */
.hilight .l { color: #ae81ff } /* Literal */
.hilight .n { color: #f8f8f2 } /* Name */
.hilight .o { color: #f92672 } /* Operator */
.hilight .p { color: #f8f8f2 } /* Punctuation */
.hilight .ch { color: #75715e } /* Comment.Hashbang */
.hilight .cm { color: #75715e } /* Comment.Multiline */
.hilight .cp { color: #75715e } /* Comment.Preproc */
.hilight .cpf { color: #75715e } /* Comment.PreprocFile */
.hilight .c1 { color: #75715e } /* Comment.Single */
.hilight .cs { color: #75715e } /* Comment.Special */
.hilight .gd { color: #f92672 } /* Generic.Deleted */
.hilight .ge { font-style: italic } /* Generic.Emph */
.hilight .gi { color: #a6e22e } /* Generic.Inserted */
.hilight .gs { font-weight: bold } /* Generic.Strong */
.hilight .gu { color: #75715e } /* Generic.Subheading */
.hilight .kc { color: #66d9ef } /* Keyword.Constant */
.hilight .kd { color: #66d9ef } /* Keyword.Declaration */
.hilight .kn { color: #f92672 } /* Keyword.Namespace */
.hilight .kp { color: #66d9ef } /* Keyword.Pseudo */
.hilight .kr { color: #66d9ef } /* Keyword.Reserved */
.hilight .kt { color: #66d9ef } /* Keyword.Type */
.hilight .ld { color: #e6db74 } /* Literal.Date */
.hilight .m { color: #ae81ff } /* Literal.Number */
.hilight .s { color: #e6db74 } /* Literal.String */
.hilight .na { color: #a6e22e } /* Name.Attribute */
.hilight .nb { color: #f8f8f2 } /* Name.Builtin */
.hilight .nc { color: #a6e22e } /* Name.Class */
.hilight .no { color: #66d9ef } /* Name.Constant */
.hilight .nd { color: #a6e22e } /* Name.Decorator */
.hilight .ni { color: #f8f8f2 } /* Name.Entity */
.hilight .ne { color: #a6e22e } /* Name.Exception */
.hilight .nf { color: #a6e22e } /* Name.Function */
.hilight .nl { color: #f8f8f2 } /* Name.Label */
.hilight .nn { color: #f8f8f2 } /* Name.Namespace */
.hilight .nx { color: #a6e22e } /* Name.Other */
.hilight .py { color: #f8f8f2 } /* Name.Property */
.hilight .nt { color: #f92672 } /* Name.Tag */
.hilight .nv { color: #f8f8f2 } /* Name.Variable */
.hilight .ow { color: #f92672 } /* Operator.Word */
.hilight .w { color: #f8f8f2 } /* Text.Whitespace */
.hilight .mb { color: #ae81ff } /* Literal.Number.Bin */
.hilight .mf { color: #ae81ff } /* Literal.Number.Float */
.hilight .mh { color: #ae81ff } /* Literal.Number.Hex */
.hilight .mi { color: #ae81ff } /* Literal.Number.Integer */
.hilight .mo { color: #ae81ff } /* Literal.Number.Oct */
.hilight .sb { color: #e6db74 } /* Literal.String.Backtick */
.hilight .sc { color: #e6db74 } /* Literal.String.Char */
.hilight .sd { color: #e6db74 } /* Literal.String.Doc */
.hilight .s2 { color: #e6db74 } /* Literal.String.Double */
.hilight .se { color: #ae81ff } /* Literal.String.Escape */
.hilight .sh { color: #e6db74 } /* Literal.String.Heredoc */
.hilight .si { color: #e6db74 } /* Literal.String.Interpol */
.hilight .sx { color: #e6db74 } /* Literal.String.Other */
.hilight .sr { color: #e6db74 } /* Literal.String.Regex */
.hilight .s1 { color: #e6db74 } /* Literal.String.Single */
.hilight .ss { color: #e6db74 } /* Literal.String.Symbol */
.hilight .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.hilight .vc { color: #f8f8f2 } /* Name.Variable.Class */
.hilight .vg { color: #f8f8f2 } /* Name.Variable.Global */
.hilight .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.hilight .il { color: #ae81ff } /* Literal.Number.Integer.Long */
hr {
border-style: hidden;
height: 2px;
background: #f1f1f1;
margin-top: 25px;
}
</style>
</head>
<body>
<div class="markdown">
<h1>CodePDF</h1>
<p>Creates PDF/HTML files from code/markdown files.</p>
<h2>Dependencies:</h2>
<p>These are system package dependencies.</p>
<ul>
<li><strong>Python 3+</strong> (<code>python3</code>):
    This program uses python 3 features, and is not compatible with Python 2.</li>
<li><strong>WKHtmlToPDF</strong> (<code>wkhtmltopdf</code>):
    Converts HTML to PDF, and is required by <code>pdfkit</code>.</li>
</ul>
<h3>Python package dependencies:</h3>
<p>These packages can be installed with <code>pip</code>.</p>
<ul>
<li><strong>Docopt</strong> (<code>docopt</code>):
    Used for command-line argument parsing.</li>
<li><strong>Markdown</strong> (<code>markdown</code>):
    Used for converting markdown files.</li>
<li><strong>PdfKit</strong> (<code>pdfkit</code>):
    Used for converting html to pdf.</li>
<li><strong>Pygments</strong> (<code>pygments</code>):
    Used for converting code files.</li>
</ul>
<h2>Installation:</h2>
<p>I recommend symlinking this script somewhere in your <code>$PATH</code>:</p>
<table class="hilighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%">1
2
3</pre></div></td><td class="code"><div class="hilight" style="background: #272822"><pre style="line-height: 125%"><span></span>git clone https://github.com/welbornprod/codepdf.git
<span style="color: #f8f8f2">cd</span> codepdf
ln -s <span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">$PWD</span><span style="color: #e6db74">/codepdf.py&quot;</span> ~/.local/bin/codepdf
</pre></div>
</td></tr></table>

<h2>Command line help:</h2>
<table class="hilighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="hilight" style="background: #272822"><pre style="line-height: 125%"><span></span>Usage:
    codepdf -h | -S | -v
    codepdf [FILE...] [-f] [-H] [-l] [-o file] [-s style] [-t title] [-D]

Options:
    FILE                    : File names to convert, or - for stdin.
                              If no names are given, stdin is used.
    -D,--debug              : Print some debug info while running.
    -f,--forcemd            : Highlight markdown syntax, instead of
                              converting to HTML.
    -h,--help               : Show this help message.
    -H,--html               : Output in HTML instead of PDF.
                              Using .htm or .html as the output file
                              extension will automatically set this flag.
    -l,--linenumbers        : Use line numbers.
    -o file,--out file      : Output file name.
                              Default: &lt;input_basename&gt;.pdf
    -s name,--style name    : Pygments style name to use for code files.
                              Default: default
    -S,--styles             : Print all known pygments styles.
    -t title,--title title  : Title for the PDF.
                              Default: &lt;input_filename&gt;
    -v,--version            : Show version.
</pre></div>
</td></tr></table>

<h2>Config:</h2>
<p>The <code>forcemd</code>, <code>html</code>, <code>linenumbers</code>, <code>style</code>, and <code>title</code> options can be
set permanently in a config file (<code>codepdf.json</code>).</p>
<p>The file can be located in your home dir (<code>~</code>),
the current working dir (<code>$PWD</code>),
or next to <code>codepdf.py</code>.</p>
<p>The directories are tried in that order.</p>
<p>Single line javascript comments are acceptable.</p>
<h3>Example config (codepdf.json):</h3>
<table class="hilighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="hilight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">{</span>
    <span style="color: #75715e">// Syntax highlight markdown files instead of converting to HTML.</span>
    <span style="color: #e6db74">&quot;forcemd&quot;</span><span style="color: #f92672">:</span> <span style="color: #66d9ef">false</span><span style="color: #f8f8f2">,</span>
    <span style="color: #75715e">// Use HTML output instead of PDF.</span>
    <span style="color: #e6db74">&quot;html&quot;</span><span style="color: #f92672">:</span> <span style="color: #66d9ef">false</span><span style="color: #f8f8f2">,</span>
    <span style="color: #75715e">// Use line numbers for source files and readme code sections.</span>
    <span style="color: #e6db74">&quot;linenumbers&quot;</span><span style="color: #f92672">:</span> <span style="color: #66d9ef">false</span><span style="color: #f8f8f2">,</span>
    <span style="color: #75715e">// Pygments style to use.</span>
    <span style="color: #e6db74">&quot;style&quot;</span><span style="color: #f92672">:</span> <span style="color: #e6db74">&quot;default&quot;</span><span style="color: #f8f8f2">,</span>
    <span style="color: #75715e">// Title for the output PDF/HTML.</span>
    <span style="color: #e6db74">&quot;title&quot;</span><span style="color: #f92672">:</span> <span style="color: #66d9ef">null</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
</td></tr></table>

<h2>Examples:</h2>
<p><a href="example.html">example.html</a>
is an HTML file that was created by running:</p>
<table class="hilighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%">1</pre></div></td><td class="code"><div class="hilight" style="background: #272822"><pre style="line-height: 125%"><span></span>codepdf README.md requirements.txt codepdf.py -l -s monokai -o example.html
</pre></div>
</td></tr></table>

<p>This is the same HTML that is used to create the PDF file.</p>
<p><a href="example.pdf">example.pdf</a>
is a PDF file that was created by running:</p>
<table class="hilighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%">1</pre></div></td><td class="code"><div class="hilight" style="background: #272822"><pre style="line-height: 125%"><span></span>codepdf README.md requirements.txt codepdf.py -l -s monokai -o example.pdf
</pre></div>
</td></tr></table>
</div><hr class="nv"><div class="file">
<a href="#requirementstxt" style="text-decoration: none;">

    <svg style="vertical-align: middle; display: inline;"
    height="16" version="1.1" viewBox="0 0 16 16" width="16">
    <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0
    1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98
    0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98
    0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31
    7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
    </path></svg>
    
</a>
<h2 id="requirementstxt" style="display: inline-block">requirements.txt</h2>
<div class="hilight">
<div class="hilight"><pre><span></span><span class="lineno">1 </span>Colr&gt;=0.2.5
<span class="lineno">2 </span>docopt&gt;=0.6.2
<span class="lineno">3 </span>Markdown&gt;=2.6.6
<span class="lineno">4 </span>pdfkit&gt;=0.5.0
<span class="lineno">5 </span>Pygments&gt;=2.1.3
</pre></div>

</div>
</div><hr class="nv"><div class="file">
<a href="#codepdfpy" style="text-decoration: none;">

    <svg style="vertical-align: middle; display: inline;"
    height="16" version="1.1" viewBox="0 0 16 16" width="16">
    <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0
    1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98
    0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98
    0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31
    7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
    </path></svg>
    
</a>
<h2 id="codepdfpy" style="display: inline-block">codepdf.py</h2>
<div class="hilight">
<div class="hilight"><pre><span></span><span class="lineno">  1 </span><span class="ch">#!/usr/bin/env python3</span>
<span class="lineno">  2 </span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="lineno">  3 </span>
<span class="lineno">  4 </span><span class="sd">&quot;&quot;&quot; codepdf.py</span>
<span class="lineno">  5 </span><span class="sd">    Convert code/text files to pdf.</span>
<span class="lineno">  6 </span><span class="sd">    -Christopher Welborn 06-13-2016</span>
<span class="lineno">  7 </span><span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">  8 </span><span class="c1"># print_function just to say &quot;don&#39;t use python 2.&quot;</span>
<span class="lineno">  9 </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="lineno"> 10 </span><span class="kn">import</span> <span class="nn">inspect</span>
<span class="lineno"> 11 </span><span class="kn">import</span> <span class="nn">json</span>
<span class="lineno"> 12 </span><span class="kn">import</span> <span class="nn">os</span>
<span class="lineno"> 13 </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="lineno"> 14 </span><span class="k">try</span><span class="p">:</span>
<span class="lineno"> 15 </span>    <span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">suppress</span>
<span class="lineno"> 16 </span><span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="lineno"> 17 </span>    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Error importing contextlib.suppress: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
<span class="lineno"> 18 </span>    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<span class="lineno"> 19 </span>        <span class="c1"># Better message than &#39;cannot import name suppress&#39;</span>
<span class="lineno"> 20 </span>        <span class="k">print</span><span class="p">(</span>
<span class="lineno"> 21 </span>            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno"> 22 </span>                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">CodePDF only works with Python 3+.&#39;</span><span class="p">,</span>
<span class="lineno"> 23 </span>                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Current python version:</span><span class="se">\n</span><span class="s1">  {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno"> 24 </span>                    <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  &#39;</span><span class="p">)</span>
<span class="lineno"> 25 </span>                <span class="p">)</span>
<span class="lineno"> 26 </span>            <span class="p">)),</span>
<span class="lineno"> 27 </span>            <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
<span class="lineno"> 28 </span>        <span class="p">)</span>
<span class="lineno"> 29 </span>
<span class="lineno"> 30 </span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="lineno"> 31 </span>
<span class="lineno"> 32 </span><span class="c1"># Third-party libs.</span>
<span class="lineno"> 33 </span><span class="k">try</span><span class="p">:</span>
<span class="lineno"> 34 </span>    <span class="kn">from</span> <span class="nn">colr</span> <span class="kn">import</span> <span class="p">(</span>
<span class="lineno"> 35 </span>        <span class="n">auto_disable</span> <span class="k">as</span> <span class="n">colr_auto_disable</span><span class="p">,</span>
<span class="lineno"> 36 </span>        <span class="n">Colr</span> <span class="k">as</span> <span class="n">C</span>
<span class="lineno"> 37 </span>    <span class="p">)</span>
<span class="lineno"> 38 </span>    <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
<span class="lineno"> 39 </span>    <span class="kn">from</span> <span class="nn">markdown</span> <span class="kn">import</span> <span class="n">markdown</span>
<span class="lineno"> 40 </span>    <span class="kn">from</span> <span class="nn">markdown.extensions.codehilite</span> <span class="kn">import</span> <span class="n">CodeHiliteExtension</span>
<span class="lineno"> 41 </span>    <span class="kn">from</span> <span class="nn">markdown.extensions.fenced_code</span> <span class="kn">import</span> <span class="n">FencedCodeExtension</span>
<span class="lineno"> 42 </span>    <span class="kn">from</span> <span class="nn">markdown.extensions.sane_lists</span> <span class="kn">import</span> <span class="n">SaneListExtension</span>
<span class="lineno"> 43 </span>    <span class="kn">from</span> <span class="nn">pdfkit</span> <span class="kn">import</span> <span class="n">from_string</span> <span class="k">as</span> <span class="n">pdf_from_string</span>
<span class="lineno"> 44 </span>    <span class="kn">from</span> <span class="nn">pygments</span> <span class="kn">import</span> <span class="n">highlight</span><span class="p">,</span> <span class="n">lexers</span><span class="p">,</span> <span class="n">formatters</span><span class="p">,</span> <span class="n">styles</span>
<span class="lineno"> 45 </span>    <span class="kn">from</span> <span class="nn">pygments.util</span> <span class="kn">import</span> <span class="n">ClassNotFound</span>
<span class="lineno"> 46 </span><span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">eximpcolr</span><span class="p">:</span>
<span class="lineno"> 47 </span>    <span class="k">print</span><span class="p">(</span>
<span class="lineno"> 48 </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno"> 49 </span>            <span class="s1">&#39;Failed to import {pname}, you may need to install it:&#39;</span><span class="p">,</span>
<span class="lineno"> 50 </span>            <span class="s1">&#39;    pip install {exc.name}&#39;</span><span class="p">,</span>
<span class="lineno"> 51 </span>            <span class="s1">&#39;Original error:&#39;</span><span class="p">,</span>
<span class="lineno"> 52 </span>            <span class="s1">&#39;    {exc.msg}&#39;</span>
<span class="lineno"> 53 </span>        <span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno"> 54 </span>            <span class="n">pname</span><span class="o">=</span><span class="n">exc</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
<span class="lineno"> 55 </span>            <span class="n">exc</span><span class="o">=</span><span class="n">exc</span>
<span class="lineno"> 56 </span>        <span class="p">),</span>
<span class="lineno"> 57 </span>        <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
<span class="lineno"> 58 </span>    <span class="p">)</span>
<span class="lineno"> 59 </span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="lineno"> 60 </span>
<span class="lineno"> 61 </span><span class="c1"># Disable colors when piping output.</span>
<span class="lineno"> 62 </span><span class="n">colr_auto_disable</span><span class="p">()</span>
<span class="lineno"> 63 </span>
<span class="lineno"> 64 </span><span class="n">NAME</span> <span class="o">=</span> <span class="s1">&#39;CodePDF&#39;</span>
<span class="lineno"> 65 </span><span class="n">VERSION</span> <span class="o">=</span> <span class="s1">&#39;0.0.5&#39;</span>
<span class="lineno"> 66 </span><span class="n">VERSIONSTR</span> <span class="o">=</span> <span class="s1">&#39;{} v. {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="n">VERSION</span><span class="p">)</span>
<span class="lineno"> 67 </span><span class="n">SCRIPT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="mi">1</span><span class="p">]</span>
<span class="lineno"> 68 </span><span class="n">SCRIPTDIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="lineno"> 69 </span>
<span class="lineno"> 70 </span><span class="c1"># Global debug flag, set with --debug.</span>
<span class="lineno"> 71 </span><span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>
<span class="lineno"> 72 </span><span class="c1"># File name to trigger reading from stdin.</span>
<span class="lineno"> 73 </span><span class="n">STDIN_NAME</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
<span class="lineno"> 74 </span><span class="c1"># Default pygments style.</span>
<span class="lineno"> 75 </span><span class="n">DEFAULT_STYLE</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
<span class="lineno"> 76 </span><span class="c1"># Default pygments lexer, when it can&#39;t be detected.</span>
<span class="lineno"> 77 </span><span class="n">DEFAULT_LEXER</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span>
<span class="lineno"> 78 </span><span class="c1"># Class name for each file&#39;s div.</span>
<span class="lineno"> 79 </span><span class="n">DIV_CLASS</span> <span class="o">=</span> <span class="s1">&#39;hilight&#39;</span>
<span class="lineno"> 80 </span>
<span class="lineno"> 81 </span><span class="n">USAGESTR</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;{versionstr}</span>
<span class="lineno"> 82 </span><span class="s2">    Usage:</span>
<span class="lineno"> 83 </span><span class="s2">        {script} -h | -S | -v</span>
<span class="lineno"> 84 </span><span class="s2">        {script} [FILE...] [-f] [-H] [-l] [-n] [-o file]</span>
<span class="lineno"> 85 </span><span class="s2">                 [-s style] [-t title] [-D]</span>
<span class="lineno"> 86 </span>
<span class="lineno"> 87 </span><span class="s2">    Options:</span>
<span class="lineno"> 88 </span><span class="s2">        FILE                    : File names to convert, or {stdin} for stdin.</span>
<span class="lineno"> 89 </span><span class="s2">                                  If no names are given, stdin is used.</span>
<span class="lineno"> 90 </span><span class="s2">        -D,--debug              : Print some debug info while running.</span>
<span class="lineno"> 91 </span><span class="s2">        -f,--forcemd            : Highlight markdown syntax, instead of</span>
<span class="lineno"> 92 </span><span class="s2">                                  converting to HTML.</span>
<span class="lineno"> 93 </span><span class="s2">        -h,--help               : Show this help message.</span>
<span class="lineno"> 94 </span><span class="s2">        -H,--html               : Output in HTML instead of PDF.</span>
<span class="lineno"> 95 </span><span class="s2">                                  Using .htm or .html as the output file</span>
<span class="lineno"> 96 </span><span class="s2">                                  extension will automatically set this flag.</span>
<span class="lineno"> 97 </span><span class="s2">        -l,--linenumbers        : Use line numbers.</span>
<span class="lineno"> 98 </span><span class="s2">        -n,--noconfig           : Ignore config file settings.</span>
<span class="lineno"> 99 </span><span class="s2">        -o file,--out file      : Output file name.</span>
<span class="lineno">100 </span><span class="s2">                                  Default: &lt;input_basename&gt;.pdf</span>
<span class="lineno">101 </span><span class="s2">        -s name,--style name    : Pygments style name to use for code files.</span>
<span class="lineno">102 </span><span class="s2">                                  Default: {default_style}</span>
<span class="lineno">103 </span><span class="s2">        -S,--styles             : Print all known pygments styles.</span>
<span class="lineno">104 </span><span class="s2">        -t title,--title title  : Title for the PDF.</span>
<span class="lineno">105 </span><span class="s2">                                  Default: &lt;input_filename&gt;</span>
<span class="lineno">106 </span><span class="s2">        -v,--version            : Show version.</span>
<span class="lineno">107 </span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">108 </span>    <span class="n">default_style</span><span class="o">=</span><span class="n">DEFAULT_STYLE</span><span class="p">,</span>
<span class="lineno">109 </span>    <span class="n">script</span><span class="o">=</span><span class="n">SCRIPT</span><span class="p">,</span>
<span class="lineno">110 </span>    <span class="n">stdin</span><span class="o">=</span><span class="n">STDIN_NAME</span><span class="p">,</span>
<span class="lineno">111 </span>    <span class="n">versionstr</span><span class="o">=</span><span class="n">VERSIONSTR</span>
<span class="lineno">112 </span><span class="p">)</span>
<span class="lineno">113 </span>
<span class="lineno">114 </span>
<span class="lineno">115 </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argd</span><span class="p">):</span>
<span class="lineno">116 </span>    <span class="sd">&quot;&quot;&quot; Main entry point, expects doctopt arg dict as argd. &quot;&quot;&quot;</span>
<span class="lineno">117 </span>    <span class="k">global</span> <span class="n">DEBUG</span>
<span class="lineno">118 </span>    <span class="n">DEBUG</span> <span class="o">=</span> <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--debug&#39;</span><span class="p">]</span>
<span class="lineno">119 </span>    <span class="c1"># Load user config, if applicable.</span>
<span class="lineno">120 </span>    <span class="n">argd</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">argd</span><span class="p">)</span>
<span class="lineno">121 </span>
<span class="lineno">122 </span>    <span class="k">if</span> <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--styles&#39;</span><span class="p">]:</span>
<span class="lineno">123 </span>        <span class="k">return</span> <span class="n">print_styles</span><span class="p">()</span>
<span class="lineno">124 </span>
<span class="lineno">125 </span>    <span class="n">filenames</span> <span class="o">=</span> <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;FILE&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">[</span><span class="n">STDIN_NAME</span><span class="p">]</span>
<span class="lineno">126 </span>    <span class="n">html_mode</span> <span class="o">=</span> <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--html&#39;</span><span class="p">]</span>
<span class="lineno">127 </span>    <span class="n">outname</span> <span class="o">=</span> <span class="n">get_output_name</span><span class="p">(</span>
<span class="lineno">128 </span>        <span class="n">filenames</span><span class="p">,</span>
<span class="lineno">129 </span>        <span class="n">output_name</span><span class="o">=</span><span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--out&#39;</span><span class="p">],</span>
<span class="lineno">130 </span>        <span class="n">html_mode</span><span class="o">=</span><span class="n">html_mode</span><span class="p">,</span>
<span class="lineno">131 </span>    <span class="p">)</span>
<span class="lineno">132 </span>    <span class="c1"># Check for user-provided .html output file.</span>
<span class="lineno">133 </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">html_mode</span><span class="p">:</span>
<span class="lineno">134 </span>        <span class="n">html_mode</span> <span class="o">=</span> <span class="n">outname</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.htm&#39;</span><span class="p">,</span> <span class="s1">&#39;.html&#39;</span><span class="p">))</span>
<span class="lineno">135 </span>
<span class="lineno">136 </span>    <span class="n">success</span> <span class="o">=</span> <span class="n">convert_files</span><span class="p">(</span>
<span class="lineno">137 </span>        <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;FILE&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">[</span><span class="n">STDIN_NAME</span><span class="p">],</span>
<span class="lineno">138 </span>        <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--out&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">get_output_name</span><span class="p">(</span><span class="n">filenames</span><span class="p">),</span>
<span class="lineno">139 </span>        <span class="n">stylename</span><span class="o">=</span><span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--style&#39;</span><span class="p">],</span>
<span class="lineno">140 </span>        <span class="n">linenos</span><span class="o">=</span><span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--linenumbers&#39;</span><span class="p">],</span>
<span class="lineno">141 </span>        <span class="n">title</span><span class="o">=</span><span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--title&#39;</span><span class="p">],</span>
<span class="lineno">142 </span>        <span class="n">force_highlight</span><span class="o">=</span><span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--forcemd&#39;</span><span class="p">],</span>
<span class="lineno">143 </span>        <span class="n">html_mode</span><span class="o">=</span><span class="n">html_mode</span><span class="p">,</span>
<span class="lineno">144 </span>    <span class="p">)</span>
<span class="lineno">145 </span>    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
<span class="lineno">146 </span>        <span class="k">print</span><span class="p">(</span><span class="n">outname</span><span class="p">)</span>
<span class="lineno">147 </span>        <span class="k">return</span> <span class="mi">0</span>
<span class="lineno">148 </span>    <span class="k">return</span> <span class="mi">1</span>
<span class="lineno">149 </span>
<span class="lineno">150 </span>
<span class="lineno">151 </span><span class="k">def</span> <span class="nf">build_html</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">styles</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="lineno">152 </span>    <span class="sd">&quot;&quot;&quot; Try to build a somewhat-sane html page from a body and style-defs. &quot;&quot;&quot;</span>
<span class="lineno">153 </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">styles</span><span class="p">:</span>
<span class="lineno">154 </span>        <span class="n">styles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;body {font-family: sans-serif;}&#39;</span><span class="p">]</span>
<span class="lineno">155 </span>    <span class="k">else</span><span class="p">:</span>
<span class="lineno">156 </span>        <span class="n">styles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">styles</span><span class="p">)</span>
<span class="lineno">157 </span>        <span class="n">styles</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;body {font-family: sans-serif;}&#39;</span><span class="p">)</span>
<span class="lineno">158 </span>
<span class="lineno">159 </span>    <span class="n">styles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">160 </span>        <span class="s1">&#39;hr {&#39;</span><span class="p">,</span>
<span class="lineno">161 </span>        <span class="s1">&#39;border-style: hidden;&#39;</span><span class="p">,</span>
<span class="lineno">162 </span>        <span class="s1">&#39;height: 2px;&#39;</span><span class="p">,</span>
<span class="lineno">163 </span>        <span class="s1">&#39;background: #f1f1f1;&#39;</span><span class="p">,</span>
<span class="lineno">164 </span>        <span class="s1">&#39;margin-top: 25px;&#39;</span><span class="p">,</span>
<span class="lineno">165 </span>        <span class="s1">&#39;}&#39;</span><span class="p">,</span>
<span class="lineno">166 </span>    <span class="p">)))</span>
<span class="lineno">167 </span>    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">168 </span>        <span class="s1">&#39;&lt;html&gt;&#39;</span><span class="p">,</span>
<span class="lineno">169 </span>        <span class="s1">&#39;&lt;head&gt;&#39;</span><span class="p">,</span>
<span class="lineno">170 </span>        <span class="s1">&#39;&lt;title&gt;{}&lt;/title&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="lineno">171 </span>        <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;&#39;</span><span class="p">,</span>
<span class="lineno">172 </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">styles</span><span class="p">),</span>
<span class="lineno">173 </span>        <span class="s1">&#39;&lt;/style&gt;&#39;</span><span class="p">,</span>
<span class="lineno">174 </span>        <span class="s1">&#39;&lt;/head&gt;&#39;</span><span class="p">,</span>
<span class="lineno">175 </span>        <span class="s1">&#39;&lt;body&gt;&#39;</span><span class="p">,</span>
<span class="lineno">176 </span>        <span class="n">body</span><span class="p">,</span>
<span class="lineno">177 </span>        <span class="s1">&#39;&lt;/body&gt;&#39;</span><span class="p">,</span>
<span class="lineno">178 </span>        <span class="s1">&#39;&lt;/html&gt;&#39;</span>
<span class="lineno">179 </span>    <span class="p">))</span>
<span class="lineno">180 </span>
<span class="lineno">181 </span>
<span class="lineno">182 </span><span class="k">def</span> <span class="nf">convert_files</span><span class="p">(</span>
<span class="lineno">183 </span>        <span class="n">filenames</span><span class="p">,</span> <span class="n">outputname</span><span class="p">,</span>
<span class="lineno">184 </span>        <span class="n">stylename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">linenos</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="lineno">185 </span>        <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force_highlight</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">html_mode</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="lineno">186 </span>    <span class="sd">&quot;&quot;&quot; Convert all files into a single PDF. &quot;&quot;&quot;</span>
<span class="lineno">187 </span>    <span class="n">stylename</span> <span class="o">=</span> <span class="n">stylename</span> <span class="ow">or</span> <span class="n">DEFAULT_STYLE</span>
<span class="lineno">188 </span>    <span class="n">debug</span><span class="p">(</span>
<span class="lineno">189 </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">190 </span>            <span class="s1">&#39;Converting files:</span><span class="se">\n</span><span class="s1">    {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">191 </span>                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">    &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">)</span>
<span class="lineno">192 </span>            <span class="p">),</span>
<span class="lineno">193 </span>            <span class="s1">&#39;Output file: {outfile}&#39;</span><span class="p">,</span>
<span class="lineno">194 </span>            <span class="s1">&#39;     Forced: {forced}&#39;</span><span class="p">,</span>
<span class="lineno">195 </span>            <span class="s1">&#39;    LineNos: {linenos}&#39;</span><span class="p">,</span>
<span class="lineno">196 </span>            <span class="s1">&#39;      Style: {style}&#39;</span><span class="p">,</span>
<span class="lineno">197 </span>            <span class="s1">&#39;      Title: {title}&#39;</span><span class="p">,</span>
<span class="lineno">198 </span>        <span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">199 </span>            <span class="n">outfile</span><span class="o">=</span><span class="n">outputname</span><span class="p">,</span>
<span class="lineno">200 </span>            <span class="n">forced</span><span class="o">=</span><span class="n">force_highlight</span><span class="p">,</span>
<span class="lineno">201 </span>            <span class="n">linenos</span><span class="o">=</span><span class="n">linenos</span><span class="p">,</span>
<span class="lineno">202 </span>            <span class="n">style</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">203 </span>            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<span class="lineno">204 </span>        <span class="p">)</span>
<span class="lineno">205 </span>    <span class="p">)</span>
<span class="lineno">206 </span>    <span class="n">htmlcontent</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno">207 </span>    <span class="n">styledefs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno">208 </span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>
<span class="lineno">209 </span>        <span class="n">titletext</span> <span class="o">=</span> <span class="n">title</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="lineno">210 </span>        <span class="k">if</span> <span class="n">titletext</span> <span class="ow">in</span> <span class="p">(</span><span class="n">STDIN_NAME</span><span class="p">,):</span>
<span class="lineno">211 </span>            <span class="n">titletext</span> <span class="o">=</span> <span class="s1">&#39;stdin&#39;</span>
<span class="lineno">212 </span>        <span class="n">formatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span>
<span class="lineno">213 </span>            <span class="n">stylename</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">214 </span>            <span class="n">linenos</span><span class="o">=</span><span class="n">linenos</span><span class="p">,</span>
<span class="lineno">215 </span>            <span class="n">title</span><span class="o">=</span><span class="n">titletext</span><span class="p">,</span>
<span class="lineno">216 </span>        <span class="p">)</span>
<span class="lineno">217 </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">styledefs</span><span class="p">:</span>
<span class="lineno">218 </span>            <span class="n">styledefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">formatter</span><span class="o">.</span><span class="n">get_style_defs</span><span class="p">())</span>
<span class="lineno">219 </span>        <span class="n">htmlcontent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span class="lineno">220 </span>            <span class="n">convert_to_html_div</span><span class="p">(</span>
<span class="lineno">221 </span>                <span class="n">filename</span><span class="p">,</span>
<span class="lineno">222 </span>                <span class="n">formatter</span><span class="p">,</span>
<span class="lineno">223 </span>                <span class="n">stylename</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">224 </span>                <span class="n">linenos</span><span class="o">=</span><span class="n">linenos</span><span class="p">,</span>
<span class="lineno">225 </span>                <span class="n">force_highlight</span><span class="o">=</span><span class="n">force_highlight</span>
<span class="lineno">226 </span>            <span class="p">)</span>
<span class="lineno">227 </span>        <span class="p">)</span>
<span class="lineno">228 </span>    <span class="n">allcontent</span> <span class="o">=</span> <span class="n">build_html</span><span class="p">(</span>
<span class="lineno">229 </span>        <span class="s1">&#39;&lt;hr class=&quot;nv&quot;&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">htmlcontent</span><span class="p">),</span>
<span class="lineno">230 </span>        <span class="n">styles</span><span class="o">=</span><span class="n">styledefs</span><span class="p">,</span>
<span class="lineno">231 </span>        <span class="n">title</span><span class="o">=</span><span class="n">titletext</span>
<span class="lineno">232 </span>    <span class="p">)</span>
<span class="lineno">233 </span>    <span class="k">if</span> <span class="n">html_mode</span><span class="p">:</span>
<span class="lineno">234 </span>        <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Writing HTML to file...&#39;</span><span class="p">)</span>
<span class="lineno">235 </span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="lineno">236 </span>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">allcontent</span><span class="p">)</span>
<span class="lineno">237 </span>        <span class="k">return</span> <span class="bp">True</span>
<span class="lineno">238 </span>
<span class="lineno">239 </span>    <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Converting to PDF...&#39;</span><span class="p">)</span>
<span class="lineno">240 </span>    <span class="k">return</span> <span class="n">pdf_from_string</span><span class="p">(</span>
<span class="lineno">241 </span>        <span class="n">allcontent</span><span class="p">,</span>
<span class="lineno">242 </span>        <span class="n">outputname</span><span class="p">,</span>
<span class="lineno">243 </span>        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;--title&#39;</span><span class="p">:</span> <span class="n">titletext</span><span class="p">,</span> <span class="s1">&#39;--quiet&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="lineno">244 </span>    <span class="p">)</span>
<span class="lineno">245 </span>
<span class="lineno">246 </span>
<span class="lineno">247 </span><span class="k">def</span> <span class="nf">convert_hilight</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
<span class="lineno">248 </span>    <span class="sd">&quot;&quot;&quot; Highlight a file with pygments, and return the resulting HTML div. &quot;&quot;&quot;</span>
<span class="lineno">249 </span>    <span class="n">displayname</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">get_file_content</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="lineno">250 </span>    <span class="n">lexer</span> <span class="o">=</span> <span class="n">get_file_lexer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<span class="lineno">251 </span>    <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Highlighting: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">displayname</span><span class="p">))</span>
<span class="lineno">252 </span>    <span class="n">linkid</span> <span class="o">=</span> <span class="n">get_elem_id</span><span class="p">(</span><span class="n">displayname</span><span class="p">)</span>
<span class="lineno">253 </span>    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">254 </span>        <span class="s1">&#39;&lt;div class=&quot;file&quot;&gt;&#39;</span><span class="p">,</span>
<span class="lineno">255 </span>        <span class="n">get_permalink_html</span><span class="p">(</span><span class="n">linkid</span><span class="p">),</span>
<span class="lineno">256 </span>        <span class="s1">&#39;&lt;h2 id=&quot;{}&quot; style=&quot;display: inline-block&quot;&gt;{}&lt;/h2&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">257 </span>            <span class="n">linkid</span><span class="p">,</span>
<span class="lineno">258 </span>            <span class="n">displayname</span>
<span class="lineno">259 </span>        <span class="p">),</span>
<span class="lineno">260 </span>        <span class="s1">&#39;&lt;div class=&quot;{}&quot;&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DIV_CLASS</span><span class="p">),</span>
<span class="lineno">261 </span>        <span class="n">highlight</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">lexer</span><span class="p">,</span> <span class="n">formatter</span><span class="p">),</span>
<span class="lineno">262 </span>        <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span>
<span class="lineno">263 </span>        <span class="s1">&#39;&lt;/div&gt;&#39;</span>
<span class="lineno">264 </span>    <span class="p">))</span>
<span class="lineno">265 </span>
<span class="lineno">266 </span>
<span class="lineno">267 </span><span class="k">def</span> <span class="nf">convert_markdown</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">stylename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">linenos</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="lineno">268 </span>    <span class="sd">&quot;&quot;&quot; Convert a markdown file to an HTML div, and return the result. &quot;&quot;&quot;</span>
<span class="lineno">269 </span>    <span class="n">displayname</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">get_file_content</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="lineno">270 </span>    <span class="n">stylename</span> <span class="o">=</span> <span class="n">stylename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">stylename</span> <span class="k">else</span> <span class="n">DEFAULT_STYLE</span>
<span class="lineno">271 </span>    <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Converting MD: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">displayname</span><span class="p">))</span>
<span class="lineno">272 </span>    <span class="n">hilighter</span> <span class="o">=</span> <span class="n">CodeHiliteExtension</span><span class="p">(</span>
<span class="lineno">273 </span>        <span class="n">pygments_style</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">274 </span>        <span class="n">linenums</span><span class="o">=</span><span class="n">linenos</span><span class="p">,</span>
<span class="lineno">275 </span>        <span class="n">noclasses</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="lineno">276 </span>        <span class="n">css_class</span><span class="o">=</span><span class="s1">&#39;hilight&#39;</span><span class="p">,</span>
<span class="lineno">277 </span>    <span class="p">)</span>
<span class="lineno">278 </span>    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">279 </span>        <span class="s1">&#39;&lt;div class=&quot;markdown&quot;&gt;&#39;</span><span class="p">,</span>
<span class="lineno">280 </span>        <span class="n">markdown</span><span class="p">(</span>
<span class="lineno">281 </span>            <span class="n">content</span><span class="p">,</span>
<span class="lineno">282 </span>            <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;html5&#39;</span><span class="p">,</span>
<span class="lineno">283 </span>            <span class="n">extensions</span><span class="o">=</span><span class="p">[</span>
<span class="lineno">284 </span>                <span class="n">hilighter</span><span class="p">,</span>
<span class="lineno">285 </span>                <span class="n">FencedCodeExtension</span><span class="p">(),</span>
<span class="lineno">286 </span>                <span class="n">SaneListExtension</span><span class="p">(),</span>
<span class="lineno">287 </span>            <span class="p">]</span>
<span class="lineno">288 </span>        <span class="p">),</span>
<span class="lineno">289 </span>        <span class="s1">&#39;&lt;/div&gt;&#39;</span>
<span class="lineno">290 </span>    <span class="p">))</span>
<span class="lineno">291 </span>
<span class="lineno">292 </span>
<span class="lineno">293 </span><span class="k">def</span> <span class="nf">convert_to_html_div</span><span class="p">(</span>
<span class="lineno">294 </span>        <span class="n">filename</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span>
<span class="lineno">295 </span>        <span class="n">stylename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">linenos</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">force_highlight</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="lineno">296 </span>    <span class="sd">&quot;&quot;&quot; Convert a file to an html div.</span>
<span class="lineno">297 </span><span class="sd">        The conversion method depends on the file extension.</span>
<span class="lineno">298 </span><span class="sd">        build_html() should be used with the content returned here.</span>
<span class="lineno">299 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">300 </span>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">force_highlight</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.md&#39;</span><span class="p">,</span> <span class="s1">&#39;.markdown&#39;</span><span class="p">)):</span>
<span class="lineno">301 </span>        <span class="k">return</span> <span class="n">convert_markdown</span><span class="p">(</span>
<span class="lineno">302 </span>            <span class="n">filename</span><span class="p">,</span>
<span class="lineno">303 </span>            <span class="n">stylename</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">304 </span>            <span class="n">linenos</span><span class="o">=</span><span class="n">linenos</span>
<span class="lineno">305 </span>        <span class="p">)</span>
<span class="lineno">306 </span>    <span class="k">return</span> <span class="n">convert_hilight</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
<span class="lineno">307 </span>
<span class="lineno">308 </span>
<span class="lineno">309 </span><span class="k">def</span> <span class="nf">debug</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="lineno">310 </span>    <span class="sd">&quot;&quot;&quot; Print a message only if DEBUG is truthy. &quot;&quot;&quot;</span>
<span class="lineno">311 </span>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="n">args</span><span class="p">):</span>
<span class="lineno">312 </span>        <span class="k">return</span> <span class="bp">None</span>
<span class="lineno">313 </span>
<span class="lineno">314 </span>    <span class="c1"># Include parent class name when given.</span>
<span class="lineno">315 </span>    <span class="n">parent</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parent&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="lineno">316 </span>    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
<span class="lineno">317 </span>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;parent&#39;</span><span class="p">)</span>
<span class="lineno">318 </span>
<span class="lineno">319 </span>    <span class="c1"># Go back more than once when given.</span>
<span class="lineno">320 </span>    <span class="n">backlevel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;back&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">321 </span>    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
<span class="lineno">322 </span>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;back&#39;</span><span class="p">)</span>
<span class="lineno">323 </span>
<span class="lineno">324 </span>    <span class="n">frame</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span>
<span class="lineno">325 </span>    <span class="c1"># Go back a number of frames (usually 1).</span>
<span class="lineno">326 </span>    <span class="k">while</span> <span class="n">backlevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="lineno">327 </span>        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_back</span>
<span class="lineno">328 </span>        <span class="n">backlevel</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="lineno">329 </span>    <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="lineno">330 </span>    <span class="n">lineno</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span>
<span class="lineno">331 </span>    <span class="k">if</span> <span class="n">parent</span><span class="p">:</span>
<span class="lineno">332 </span>        <span class="n">func</span> <span class="o">=</span> <span class="s1">&#39;{}.{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="p">)</span>
<span class="lineno">333 </span>    <span class="k">else</span><span class="p">:</span>
<span class="lineno">334 </span>        <span class="n">func</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span>
<span class="lineno">335 </span>
<span class="lineno">336 </span>    <span class="n">lineinfo</span> <span class="o">=</span> <span class="s1">&#39;{}:{} {}: &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">337 </span>        <span class="n">C</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">),</span>
<span class="lineno">338 </span>        <span class="n">C</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lineno</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;blue&#39;</span><span class="p">),</span>
<span class="lineno">339 </span>        <span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">),</span> <span class="s1">&#39;()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="lineno">340 </span>    <span class="p">)</span>
<span class="lineno">341 </span>    <span class="c1"># Patch args to stay compatible with print().</span>
<span class="lineno">342 </span>    <span class="n">pargs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
<span class="lineno">343 </span>    <span class="n">pargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">lineinfo</span><span class="p">,</span> <span class="n">pargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="lineno">344 </span>    <span class="k">print</span><span class="p">(</span><span class="o">*</span><span class="n">pargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="lineno">345 </span>
<span class="lineno">346 </span>
<span class="lineno">347 </span><span class="k">def</span> <span class="nf">get_elem_id</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="lineno">348 </span>    <span class="sd">&quot;&quot;&quot; Transform a file name or text into a slug, usable for an element id.</span>
<span class="lineno">349 </span><span class="sd">        Removes non alpha-numeric characters, replaces spaces with -.</span>
<span class="lineno">350 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">351 </span>    <span class="k">return</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="lineno">352 </span>        <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">word</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">())</span>
<span class="lineno">353 </span>        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="lineno">354 </span>    <span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="lineno">355 </span>
<span class="lineno">356 </span>
<span class="lineno">357 </span><span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="lineno">358 </span>    <span class="sd">&quot;&quot;&quot; Returns a tuple of (display_name, content), handling stdin if</span>
<span class="lineno">359 </span><span class="sd">        STDIN_NAME is used.</span>
<span class="lineno">360 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">361 </span>    <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="p">(</span><span class="n">STDIN_NAME</span><span class="p">,):</span>
<span class="lineno">362 </span>        <span class="k">return</span> <span class="s1">&#39;stdin&#39;</span><span class="p">,</span> <span class="n">read_stdin</span><span class="p">()</span>
<span class="lineno">363 </span>
<span class="lineno">364 </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="lineno">365 </span>        <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="lineno">366 </span>    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span>
<span class="lineno">367 </span>
<span class="lineno">368 </span>
<span class="lineno">369 </span><span class="k">def</span> <span class="nf">get_file_lexer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
<span class="lineno">370 </span>    <span class="sd">&quot;&quot;&quot; Try to get a lexer by file extension, guess by content if that fails.</span>
<span class="lineno">371 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">372 </span>    <span class="k">try</span><span class="p">:</span>
<span class="lineno">373 </span>        <span class="c1"># Pygments sometimes returns a weird lexer for .txt files.</span>
<span class="lineno">374 </span>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">):</span>
<span class="lineno">375 </span>            <span class="n">lexer</span> <span class="o">=</span> <span class="n">lexers</span><span class="o">.</span><span class="n">get_lexer_by_name</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="lineno">376 </span>            <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Lexer forced by extension: {:&gt;20} -&gt; {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">377 </span>                <span class="n">lexer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="lineno">378 </span>                <span class="n">filename</span><span class="p">,</span>
<span class="lineno">379 </span>            <span class="p">))</span>
<span class="lineno">380 </span>        <span class="k">else</span><span class="p">:</span>
<span class="lineno">381 </span>            <span class="n">lexer</span> <span class="o">=</span> <span class="n">lexers</span><span class="o">.</span><span class="n">get_lexer_for_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="lineno">382 </span>            <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Lexer chosen by file name: {:&gt;20} -&gt; {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">383 </span>                <span class="n">lexer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="lineno">384 </span>                <span class="n">filename</span><span class="p">,</span>
<span class="lineno">385 </span>            <span class="p">))</span>
<span class="lineno">386 </span>    <span class="k">except</span> <span class="n">ClassNotFound</span><span class="p">:</span>
<span class="lineno">387 </span>        <span class="k">try</span><span class="p">:</span>
<span class="lineno">388 </span>            <span class="c1"># Guess by content.</span>
<span class="lineno">389 </span>            <span class="n">lexer</span> <span class="o">=</span> <span class="n">lexers</span><span class="o">.</span><span class="n">guess_lexer</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="lineno">390 </span>            <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Lexer guessed by content:  {:&gt;20} -&gt; {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">391 </span>                <span class="n">lexer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="lineno">392 </span>                <span class="n">filename</span><span class="p">,</span>
<span class="lineno">393 </span>            <span class="p">))</span>
<span class="lineno">394 </span>        <span class="k">except</span> <span class="n">ClassNotFound</span><span class="p">:</span>
<span class="lineno">395 </span>            <span class="c1"># Fall back to default lexer.</span>
<span class="lineno">396 </span>            <span class="n">lexer</span> <span class="o">=</span> <span class="n">lexers</span><span class="o">.</span><span class="n">get_lexer_by_name</span><span class="p">(</span><span class="n">DEFAULT_LEXER</span><span class="p">)</span>
<span class="lineno">397 </span>            <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Lexer set to default:      {:&gt;20} -&gt; {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">398 </span>                <span class="n">lexer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="lineno">399 </span>                <span class="n">filename</span><span class="p">,</span>
<span class="lineno">400 </span>            <span class="p">))</span>
<span class="lineno">401 </span>    <span class="k">return</span> <span class="n">lexer</span>
<span class="lineno">402 </span>
<span class="lineno">403 </span>
<span class="lineno">404 </span><span class="k">def</span> <span class="nf">get_formatter</span><span class="p">(</span><span class="n">stylename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">linenos</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="lineno">405 </span>    <span class="sd">&quot;&quot;&quot; Get an HTMLFormatter from pygments. &quot;&quot;&quot;</span>
<span class="lineno">406 </span>    <span class="n">stylename</span> <span class="o">=</span> <span class="n">stylename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">stylename</span> <span class="k">else</span> <span class="n">DEFAULT_STYLE</span>
<span class="lineno">407 </span>    <span class="k">try</span><span class="p">:</span>
<span class="lineno">408 </span>        <span class="n">formatter</span> <span class="o">=</span> <span class="n">formatters</span><span class="o">.</span><span class="n">HtmlFormatter</span><span class="p">(</span>
<span class="lineno">409 </span>            <span class="n">cssclass</span><span class="o">=</span><span class="n">DIV_CLASS</span><span class="p">,</span>
<span class="lineno">410 </span>            <span class="n">linenos</span><span class="o">=</span><span class="s1">&#39;inline&#39;</span> <span class="k">if</span> <span class="n">linenos</span> <span class="ow">is</span> <span class="bp">True</span> <span class="k">else</span> <span class="n">linenos</span><span class="p">,</span>
<span class="lineno">411 </span>            <span class="n">style</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">412 </span>            <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span>
<span class="lineno">413 </span>            <span class="n">title</span><span class="o">=</span><span class="n">title</span>
<span class="lineno">414 </span>        <span class="p">)</span>
<span class="lineno">415 </span>    <span class="k">except</span> <span class="n">ClassNotFound</span><span class="p">:</span>
<span class="lineno">416 </span>        <span class="k">raise</span> <span class="n">InvalidArg</span><span class="p">(</span>
<span class="lineno">417 </span>            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">418 </span>                <span class="s1">&#39;Unknown style name: {style}&#39;</span><span class="p">,</span>
<span class="lineno">419 </span>                <span class="s1">&#39;Run `{script} --styles` to see a list of style names.&#39;</span><span class="p">,</span>
<span class="lineno">420 </span>            <span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">421 </span>                <span class="n">style</span><span class="o">=</span><span class="n">stylename</span><span class="p">,</span>
<span class="lineno">422 </span>                <span class="n">script</span><span class="o">=</span><span class="n">SCRIPT</span><span class="p">,</span>
<span class="lineno">423 </span>            <span class="p">)</span>
<span class="lineno">424 </span>        <span class="p">)</span>
<span class="lineno">425 </span>    <span class="k">return</span> <span class="n">formatter</span>
<span class="lineno">426 </span>
<span class="lineno">427 </span>
<span class="lineno">428 </span><span class="k">def</span> <span class="nf">get_permalink_html</span><span class="p">(</span><span class="n">linkid</span><span class="p">):</span>
<span class="lineno">429 </span>    <span class="sd">&quot;&quot;&quot; Return HTML needed to build a permalink link/icon for a header. &quot;&quot;&quot;</span>
<span class="lineno">430 </span>    <span class="n">svg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="lineno">431 </span><span class="s2">    &lt;svg style=&quot;vertical-align: middle; display: inline;&quot;</span>
<span class="lineno">432 </span><span class="s2">    height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;</span>
<span class="lineno">433 </span><span class="s2">    &lt;path d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0</span>
<span class="lineno">434 </span><span class="s2">    1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98</span>
<span class="lineno">435 </span><span class="s2">    0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98</span>
<span class="lineno">436 </span><span class="s2">    0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31</span>
<span class="lineno">437 </span><span class="s2">    7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;</span>
<span class="lineno">438 </span><span class="s2">    &lt;/path&gt;&lt;/svg&gt;</span>
<span class="lineno">439 </span><span class="s2">    &quot;&quot;&quot;</span>
<span class="lineno">440 </span>    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">441 </span>        <span class="s1">&#39;&lt;a href=&quot;#{}&quot; style=&quot;text-decoration: none;&quot;&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">linkid</span><span class="p">),</span>
<span class="lineno">442 </span>        <span class="n">svg</span><span class="p">,</span>
<span class="lineno">443 </span>        <span class="s1">&#39;&lt;/a&gt;&#39;</span>
<span class="lineno">444 </span>    <span class="p">))</span>
<span class="lineno">445 </span>
<span class="lineno">446 </span>
<span class="lineno">447 </span><span class="k">def</span> <span class="nf">get_output_name</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">html_mode</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="lineno">448 </span>    <span class="sd">&quot;&quot;&quot; Determine output file name to use when the user hasn&#39;t given one. &quot;&quot;&quot;</span>
<span class="lineno">449 </span>    <span class="k">if</span> <span class="n">output_name</span><span class="p">:</span>
<span class="lineno">450 </span>        <span class="c1"># Short-circuit auto-name-detection.</span>
<span class="lineno">451 </span>        <span class="k">return</span> <span class="n">output_name</span>
<span class="lineno">452 </span>
<span class="lineno">453 </span>    <span class="n">inputname</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="lineno">454 </span>    <span class="k">if</span> <span class="n">inputname</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
<span class="lineno">455 </span>        <span class="n">inputname</span> <span class="o">=</span> <span class="s1">&#39;stdin&#39;</span>
<span class="lineno">456 </span>    <span class="n">parentdir</span><span class="p">,</span> <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">inputname</span><span class="p">)</span>
<span class="lineno">457 </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">parentdir</span><span class="p">:</span>
<span class="lineno">458 </span>        <span class="n">parentdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="lineno">459 </span>    <span class="k">return</span> <span class="s1">&#39;{name}{ext}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">460 </span>        <span class="n">name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parentdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
<span class="lineno">461 </span>        <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span> <span class="k">if</span> <span class="n">html_mode</span> <span class="k">else</span> <span class="s1">&#39;.pdf&#39;</span>
<span class="lineno">462 </span>    <span class="p">)</span>
<span class="lineno">463 </span>
<span class="lineno">464 </span>
<span class="lineno">465 </span><span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="n">argd</span><span class="p">):</span>
<span class="lineno">466 </span>    <span class="sd">&quot;&quot;&quot; Load config from ~/.codepdf.json or ./.codepdf.json.</span>
<span class="lineno">467 </span><span class="sd">        Override argd values with user config.</span>
<span class="lineno">468 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">469 </span>    <span class="k">if</span> <span class="n">argd</span><span class="p">[</span><span class="s1">&#39;--noconfig&#39;</span><span class="p">]:</span>
<span class="lineno">470 </span>        <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Config ignored.&#39;</span><span class="p">)</span>
<span class="lineno">471 </span>        <span class="k">return</span> <span class="n">argd</span>
<span class="lineno">472 </span>
<span class="lineno">473 </span>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;codepdf.json&#39;</span>
<span class="lineno">474 </span>    <span class="k">for</span> <span class="n">trydir</span> <span class="ow">in</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="n">SCRIPTDIR</span><span class="p">):</span>
<span class="lineno">475 </span>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">trydir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="lineno">476 </span>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
<span class="lineno">477 </span>            <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Found config file: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
<span class="lineno">478 </span>            <span class="k">break</span>
<span class="lineno">479 </span>    <span class="k">else</span><span class="p">:</span>
<span class="lineno">480 </span>        <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No config file found: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="lineno">481 </span>        <span class="k">return</span> <span class="n">argd</span>
<span class="lineno">482 </span>
<span class="lineno">483 </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="lineno">484 </span>        <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;//&#39;</span><span class="p">))</span>
<span class="lineno">485 </span>
<span class="lineno">486 </span>    <span class="k">try</span><span class="p">:</span>
<span class="lineno">487 </span>        <span class="n">rawconfig</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="lineno">488 </span>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="lineno">489 </span>        <span class="k">raise</span> <span class="n">ConfigError</span><span class="p">(</span><span class="s1">&#39;Unable to load config from: {}</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">490 </span>            <span class="n">filepath</span><span class="p">,</span>
<span class="lineno">491 </span>            <span class="n">ex</span>
<span class="lineno">492 </span>        <span class="p">))</span>
<span class="lineno">493 </span>
<span class="lineno">494 </span>    <span class="c1"># Config that is allowed:</span>
<span class="lineno">495 </span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="s1">&#39;linenumbers&#39;</span><span class="p">,</span> <span class="s1">&#39;forcemd&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">):</span>
<span class="lineno">496 </span>        <span class="n">arg</span> <span class="o">=</span> <span class="s1">&#39;--{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="lineno">497 </span>        <span class="n">rawval</span> <span class="o">=</span> <span class="n">rawconfig</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="lineno">498 </span>        <span class="k">if</span> <span class="n">rawval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<span class="lineno">499 </span>            <span class="k">if</span> <span class="n">argd</span><span class="p">[</span><span class="n">arg</span><span class="p">]:</span>
<span class="lineno">500 </span>                <span class="c1"># Do no override cmdline options.</span>
<span class="lineno">501 </span>                <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Option set: {:&gt;15} == {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">argd</span><span class="p">[</span><span class="n">arg</span><span class="p">]))</span>
<span class="lineno">502 </span>            <span class="k">else</span><span class="p">:</span>
<span class="lineno">503 </span>                <span class="n">argd</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">rawval</span>
<span class="lineno">504 </span>                <span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Config set: {:&gt;15} == {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">argd</span><span class="p">[</span><span class="n">arg</span><span class="p">]))</span>
<span class="lineno">505 </span>    <span class="c1"># Argd has been overridden</span>
<span class="lineno">506 </span>    <span class="k">return</span> <span class="n">argd</span>
<span class="lineno">507 </span>
<span class="lineno">508 </span>
<span class="lineno">509 </span><span class="k">def</span> <span class="nf">print_err</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="lineno">510 </span>    <span class="sd">&quot;&quot;&quot; A wrapper for print() that uses stderr by default. &quot;&quot;&quot;</span>
<span class="lineno">511 </span>    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
<span class="lineno">512 </span>        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
<span class="lineno">513 </span>    <span class="k">print</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="lineno">514 </span>
<span class="lineno">515 </span>
<span class="lineno">516 </span><span class="k">def</span> <span class="nf">print_styles</span><span class="p">():</span>
<span class="lineno">517 </span>    <span class="sd">&quot;&quot;&quot; Print all known pygments styles and return a success status code. &quot;&quot;&quot;</span>
<span class="lineno">518 </span>    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
<span class="lineno">519 </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Style names:&#39;</span><span class="p">,</span>
<span class="lineno">520 </span>        <span class="s1">&#39;    {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="lineno">521 </span>            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">    &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">styles</span><span class="o">.</span><span class="n">STYLE_MAP</span><span class="p">))</span>
<span class="lineno">522 </span>        <span class="p">)</span>
<span class="lineno">523 </span>    <span class="p">)))</span>
<span class="lineno">524 </span>    <span class="k">return</span> <span class="mi">0</span>
<span class="lineno">525 </span>
<span class="lineno">526 </span>
<span class="lineno">527 </span><span class="k">def</span> <span class="nf">read_stdin</span><span class="p">():</span>
<span class="lineno">528 </span>    <span class="sd">&quot;&quot;&quot; Read from stdin, print a message if it&#39;s a terminal. &quot;&quot;&quot;</span>
<span class="lineno">529 </span>    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">()</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
<span class="lineno">530 </span>        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Reading from stdin until end of file (Ctrl + D)...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="lineno">531 </span>    <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="lineno">532 </span>
<span class="lineno">533 </span>
<span class="lineno">534 </span><span class="k">class</span> <span class="nc">ConfigError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<span class="lineno">535 </span>    <span class="sd">&quot;&quot;&quot; Raised when config can&#39;t be loaded due to parsing errors. &quot;&quot;&quot;</span>
<span class="lineno">536 </span>    <span class="k">pass</span>
<span class="lineno">537 </span>
<span class="lineno">538 </span>
<span class="lineno">539 </span><span class="k">class</span> <span class="nc">InvalidArg</span><span class="p">(</span><span class="n">ConfigError</span><span class="p">):</span>
<span class="lineno">540 </span>    <span class="sd">&quot;&quot;&quot; Raised when the user has used an invalid argument. &quot;&quot;&quot;</span>
<span class="lineno">541 </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="lineno">542 </span>        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
<span class="lineno">543 </span>
<span class="lineno">544 </span>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="lineno">545 </span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">:</span>
<span class="lineno">546 </span>            <span class="k">return</span> <span class="s1">&#39;Invalid argument, {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span>
<span class="lineno">547 </span>        <span class="k">return</span> <span class="s1">&#39;Invalid argument!&#39;</span>
<span class="lineno">548 </span>
<span class="lineno">549 </span>
<span class="lineno">550 </span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="lineno">551 </span>    <span class="k">try</span><span class="p">:</span>
<span class="lineno">552 </span>        <span class="n">mainret</span> <span class="o">=</span> <span class="n">main</span><span class="p">(</span><span class="n">docopt</span><span class="p">(</span><span class="n">USAGESTR</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">VERSIONSTR</span><span class="p">))</span>
<span class="lineno">553 </span>    <span class="k">except</span> <span class="n">ConfigError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="lineno">554 </span>        <span class="n">print_err</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
<span class="lineno">555 </span>        <span class="n">mainret</span> <span class="o">=</span> <span class="mi">1</span>
<span class="lineno">556 </span>    <span class="k">except</span> <span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">):</span>
<span class="lineno">557 </span>        <span class="n">print_err</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">User cancelled.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="lineno">558 </span>        <span class="n">mainret</span> <span class="o">=</span> <span class="mi">2</span>
<span class="lineno">559 </span>    <span class="k">except</span> <span class="n">BrokenPipeError</span><span class="p">:</span>
<span class="lineno">560 </span>        <span class="n">print_err</span><span class="p">(</span>
<span class="lineno">561 </span>            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Broken pipe, input/output was interrupted.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="lineno">562 </span>            <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="lineno">563 </span>        <span class="n">mainret</span> <span class="o">=</span> <span class="mi">3</span>
<span class="lineno">564 </span>    <span class="k">except</span> <span class="ne">EnvironmentError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="lineno">565 </span>        <span class="k">if</span> <span class="n">ex</span><span class="o">.</span><span class="n">strerror</span> <span class="ow">and</span> <span class="n">ex</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
<span class="lineno">566 </span>            <span class="n">print_err</span><span class="p">(</span>
<span class="lineno">567 </span>                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">{x.strerror}: {x.filename}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ex</span><span class="p">)</span>
<span class="lineno">568 </span>            <span class="p">)</span>
<span class="lineno">569 </span>        <span class="k">else</span><span class="p">:</span>
<span class="lineno">570 </span>            <span class="n">print_err</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
<span class="lineno">571 </span>        <span class="n">mainret</span> <span class="o">=</span> <span class="mi">1</span>
<span class="lineno">572 </span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">mainret</span><span class="p">)</span>
</pre></div>

</div>
</div>
</body>
</html>